<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="../js/bootstrap-table.css">
    <link rel="stylesheet" href="../js/bootstrap-table.min.css">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!--<script src="../js/bootstrap-table.js"></script>-->
    <script src="../js/bootstrap-table.min.js"></script>
    <script src="../js/bootstrap-table-locale-all.js"></script>
    <script src="../js/bootstrap-table-locale-all.min.js"></script>
    <script src="../js/bootstrap-table-toolbar.js"></script>
    <script src="../js/bootstrap-table-toolbar.min.js"></script>
    <script src="../js/bootstrap-table-export.js"></script>
    <!--<script src="//rawgit.com/hhurz/tableExport.jquery.plugin/master/tableExport.js"></script>-->
    <script src="../js/bootstrap-table-zh-CN.js"></script>
    <script  type="text/javascript">

        //初始化函数
        function init() {
            $('#users').bootstrapTable({
                url: '../user/getAllUser.do',         //请求后台的URL（*）
                method: 'get',                      //请求方式（*）
                toolbar: '#toolbar',                //工具按钮用哪个容器
                striped: false,                      //是否显示行间隔色
                cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
                pagination: true,                   //是否显示分页（*）
                sidePagination: "server",           //分页方式：client客户端分页，server服务端分页（*）
                pageNumber: 1,                       //初始化加载第一页，默认第一页
                pageSize: 10,                       //每页的记录行数（*）
                pageList: [10, 25, 50, 100, 500, 1000, 5000, 10000],        //可供选择的每页的行数（*）
                showColumns: true,                  //是否显示所有的列
                showRefresh: true,                  //是否显示刷新按钮
                minimumCountColumns: 1,             //最少允许的列数
                clickToSelect: true,                //是否启用点击选中行
                height: 1000,                        //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
                uniqueId: "ID",                     //每一行的唯一标识，一般为主键列
                //showToggle: true,                    //是否显示详细视图和列表视图的切换按钮
                cardView: false,                    //是否显示详细视图
                detailView: false,                  //是否显示父子表
                queryParams: queryParams,           //传递参数（*）
                queryParamsType: '',                //设置为 'limit' 则会发送符合 RESTFul 格式的参数.(limit格式无法访问pageNumber、pageSize)
                //search:true,                      //开启搜索框，客户端分页时，单个条件可以对多个字段自动搜索；服务端分页时，需要通过params.searchText获取搜索条件，传到控制器

                //showExport: true,                     //是否显示导出
                //exportDataType: "basic",              //basic', 'all', 'selected'.

                rowStyle: function (row, index) {
                    //这里有5个取值代表5中颜色['active', 'success', 'info', 'warning', 'danger'];
                    var strclass = "";
                    if (row.status == 1) {
                        strclass = 'info';//还有一个active
                    }
                    else if (row.status == 0) {
                        strclass = 'danger';
                    }
                    else {
                        return {};
                    }
                    return { classes: strclass }
                },

                columns: [{
                    checkbox: true
                }, {
                    field: 'id',
                    title: '编号'
                }, {
                    field: 'name',
                    title: '名字'
                }, {
                    field: 'password',
                    title: '密码'
                }, {
                    field: 'pid',
                    title: '身份证号'
                }, {
                    field: 'sex',
                    title: '性别'
                },{
                    field: 'status',
                    title: '状态',
                    formatter:function (value,row,index) {
                        return value == 1 ? "已激活" : "已冻结";
                    },
                }, {
                    field: 'email',
                    title: '邮箱',
                    // formatter:
                }],

                onLoadSuccess: function () {
                    //alert("数据加载成功")
                },
                onLoadError: function () {
                    //alert("数据加载失败！");
                }
            });
        }

        //传参函数
        function queryParams(params) {
            var searchID = document.getElementById("searchID").value;
            var searchName = document.getElementById("searchName").value;
            var searchStatus = document.getElementById("searchStatus").value;
            //console.log(params.searchText); 单条件查询
            var temp = {
                pageNumber: params.pageNumber,
                pageSize: params.pageSize,
                searchID:searchID,
                searchName:searchName,
                searchStatus:searchStatus,
            };
            return temp;
        };


        $(function () {

            //初始化页面
            init();

            //搜索按钮，destroy原有表格，然后重新初始化
            $("#search").click(function () {
                $("#users").bootstrapTable(('destroy'));
                //$('#users').bootstrapTable(('refresh')); // 很重要的一步，刷新url！更新params参数
                init("{:url('index')}","users",true);  // 重新加载表格,解决点击搜索时不自动回到第一页
            })

            //重置按钮，主要是手动把三个输入框置空值，destroy表格然后重新初始化
            $("#reset").click(function () {
                document.getElementById("searchID").value = "",
                document.getElementById("searchName").value = "",
                document.getElementById("searchStatus").value = "",
                $("#users").bootstrapTable(('destroy'));
                //$('#users').bootstrapTable(('refresh')); // 很重要的一步，刷新url！更新params参数
                init("{:url('index')}","users",true);  // 重新加载表格,解决点击搜索时不自动回到第一页
            })
        })

        //删除用户
        // function  editUser() {
        //     $("#editUserWindow").open;
        // }
    </script>
    <script type="text/javascript">
        function addUserSubmit() {
            //alert("function_addUserSubmit"),
            $.ajax({
                type: "get",
                url: "../user/addUser.do",
                dataType: "json",
                data: $("#addUserFrom").serialize(),
                //data: $("#addUserFrom").serialize(),
                async: true,
                success:function () {
                    console.log($("#addUserFrom").serialize());
                    alert("success!");

                    //alert("success：" + data);
                },
                error:function () {
                    //alert("error：" + data);
                    alert("error!");
                }
            })
        }
    </script>
</head>

<body>
<div><h2 align="center">用户列表</h2></div>

<div style="border:silver solid;border-radius:5px">
    <div style="background-color: whitesmoke;border-radius:5px"><span><h3>查询条件</h3></span></div>
    <div style="height: 100px;">
        <div style="float: left;">
            <lable class="form-inline"><h5>ID：</h5></lable>
            <input type="text" id="searchID" />
        </div>
        <div style="float: left;">
            <lable>名字：</lable>
            <input type="text" id="searchName" />
        </div>
        <div style="float: left;">
            <lable>状态：</lable>
            <select  id="searchStatus">
                <option value=""></option>
                <option value="1">已激活</option>
                <option value="0">已冻结</option>
            </select>
        </div>
        <div style="float: left;">
            <button id="search">搜索</button>
        </div>
        <div style="float: left;">
            <button id="reset">重置</button>
        </div>
    </div>
</div>

<div id="toolbar" class="btn-group">
    <!--要 data-toggle="modal" 才能弹出模态框-->
    <button type="button" class="btn btn-default" data-toggle="modal" data-target="#addUserModal">
        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>新增
    </button>
    <button  type="button" class="btn btn-default" data-toggle="modal" data-target="#editUserModal" >
        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>选择修改
    </button>
    <button type="button" class="btn btn-default" data-toggle="modal" data-target="#delUserModal">
        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>选择删除
    </button>
</div>


<div class="modal fade" id="addUserModal" tabindex="-1" role="dialog" aria-labelledby="addModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="addModalLabel">
                    增加
                </h4>
            </div>
            <!--action=""-->
            <form id="addUserFrom" onsubmit="addUserSubmit()">
                <div class="modal-body">
                    <div >
                        <label for="">名字：</label>
                        <input type="text" id="addName" />
                    </div>
                    <div >
                        <label for="">密码：</label>
                        <input type="text" id="addPassword" />
                    </div>
                    <div >
                        <label for="">身份证号：</label>
                        <input type="text" id="addPid" />
                    </div>
                    <div >
                        <label for="">性别：</label>
                        <input type="text" id="addSex" />
                    </div>
                    <div >
                        <label for="">状态：</label>
                        <select id="addStatus">
                            <option value="addStatus_1">启用</option>
                            <option value="addStatus_0">冻结</option>
                        </select>
                    </div>
                    <div >
                        <label for="">邮箱：</label>
                        <input type="text" id="addEmail" />
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                    </button>
                    <input type="submit" class="btn btn-primary" value="提交">
                    <!--<button type="button"  id="addUserBtn">-->
                    <!--提交更改-->
                    <!--</button>-->
                </div>
            </form>

        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>

<div class="modal fade" id="editUserModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="editModalLabel">
                    模态框（Modal）标题
                </h4>
            </div>
            <div class="modal-body">
                在这里添加一些文本
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                </button>
                <button type="button" class="btn btn-primary">
                    提交更改
                </button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>

<div class="modal fade" id="delUserModal" tabindex="-1" role="dialog" aria-labelledby="delModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="delModalLabel">
                    模态框（Modal）标题
                </h4>
            </div>
            <div class="modal-body">
                在这里添加一些文本
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                </button>
                <button type="button" class="btn btn-primary">
                    提交更改
                </button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>













<table class="table table-striped" id="users"></table>

</body>
</html>